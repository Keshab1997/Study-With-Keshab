<!doctype html>
<html lang="bn">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title id="dynamic-title">Loading... | Study With Keshab</title>
        
        <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/993/993872.png" />

        <!-- Stylesheets -->
        <link rel="stylesheet" href="../../../css/style.css" />
        <link rel="stylesheet" href="../../../css/navigation.css" />
        <link rel="stylesheet" href="../../../css/notification.css" />
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/pdf-viewer.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>

        <style>
            body.auth-loading { visibility: hidden; opacity: 0; }
            .main-header { display: none; } /* navigation.js ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶è‡¶ü‡¶ø ‡¶π‡¶æ‡¶á‡¶° ‡¶π‡¶¨‡ßá */
            
            /* Chapter Banner Styling */
            .chapter-banner {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
                color: white; padding: 40px 30px !important; text-align: center;
                margin: 0 0 40px 0 !important; border-bottom: 3px solid rgba(255, 255, 255, 0.2) !important;
            }
            .chapter-banner h1 { margin: 0 !important; font-size: 1.8rem !important; font-weight: 700 !important; }
            .chapter-banner p { margin: 0.5rem 0 0 0 !important; font-size: 1.1rem !important; opacity: 0.95 !important; }
            
            /* Dashboard Grid Fix */
            .quick-stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
            .stat-card { background: #fff; padding: 25px; border-radius: 16px; text-align: center; border: 1px solid #eee; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
            .stat-label { font-size: 0.9rem; color: #666; margin-bottom: 10px; }
            .stat-number { font-size: 2rem; font-weight: bold; color: #667eea; }
            
            .streak-container { display: flex; align-items: center; background: #fff5f5; padding: 25px; border-radius: 16px; margin-bottom: 30px; border-left: 5px solid #ff4d4d; }
            .streak-icon { font-size: 2.5rem; margin-right: 20px; }
            
            .motivational-quote-box { background: #f0f9ff; padding: 25px; border-radius: 16px; border-left: 5px solid #3b82f6; margin-bottom: 30px; font-size: 1rem; line-height: 1.6; }
            
            .card { margin-bottom: 30px !important; padding: 30px !important; }
            
            /* Dashboard Grid & Items */
            .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
            .dashboard-item { background: #fff; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); overflow: hidden; }
            .dashboard-item h3 { font-size: 1.1rem; margin: 0 0 15px 0; border: none; color: #333; }
            .dashboard-item canvas { max-width: 100% !important; height: auto !important; }
            
            /* Progress Bar */
            .progress-bar-container { width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden; margin: 15px 0; }
            .progress-bar { height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); border-radius: 10px; transition: width 0.5s ease; }
            
            /* Leaderboard Table */
            .leaderboard-container { overflow-x: auto; }
            .leaderboard-container table { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 20px; }
            .leaderboard-container thead th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 18px; font-size: 1.1rem; font-weight: 700; text-align: center; border: none; }
            .leaderboard-container thead th:first-child { border-radius: 12px 0 0 0; }
            .leaderboard-container thead th:last-child { border-radius: 0 12px 0 0; }
            .leaderboard-container tbody td { padding: 18px; font-size: 1.05rem; text-align: center; border-bottom: 1px solid #e9ecef; background: white; }
            .leaderboard-container tbody tr:hover td { background: #f8f9fa; }
            .leaderboard-container tbody tr:first-child td { font-weight: 700; color: #667eea; background: #f0f4ff; }
            .leaderboard-container tbody tr:last-child td { border-bottom: none; }
            
            /* Navigation Grid Premium */
            .nav-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; padding: 20px; margin: 20px 0 30px 0; max-width: 1200px; margin-left: auto; margin-right: auto; }
            .nav-button { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 25px 15px; background: white; border-radius: 16px; text-decoration: none; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border: 2px solid transparent; min-height: 100px; }
            .nav-button i { font-size: 2rem; margin-bottom: 10px; }
            .nav-button span { font-size: 0.9rem; font-weight: 600; text-align: center; line-height: 1.3; }
            .nav-button:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
            
            .color-home { border-color: #10b981; } .color-home i { color: #10b981; } .color-home span { color: #10b981; } .color-home:hover { background: #ecfdf5; }
            .color-dashboard { border-color: #3b82f6; } .color-dashboard i { color: #3b82f6; } .color-dashboard span { color: #3b82f6; } .color-dashboard:hover { background: #eff6ff; }
            .color-notes { border-color: #f59e0b; } .color-notes i { color: #f59e0b; } .color-notes span { color: #f59e0b; } .color-notes:hover { background: #fffbeb; }
            .color-pdf { border-color: #ef4444; } .color-pdf i { color: #ef4444; } .color-pdf span { color: #ef4444; } .color-pdf:hover { background: #fef2f2; }
            .color-quiz { border-color: #8b5cf6; } .color-quiz i { color: #8b5cf6; } .color-quiz span { color: #8b5cf6; } .color-quiz:hover { background: #faf5ff; }
            .color-leaderboard { border-color: #f97316; } .color-leaderboard i { color: #f97316; } .color-leaderboard span { color: #f97316; } .color-leaderboard:hover { background: #fff7ed; }
            
            @media (max-width: 768px) {
                .dashboard-grid { grid-template-columns: 1fr; }
                .dashboard-item { padding: 20px; }
                .leaderboard-container thead th { font-size: 1rem; padding: 15px; }
                .leaderboard-container tbody td { font-size: 0.95rem; padding: 15px; }
                .nav-grid { grid-template-columns: repeat(3, 1fr); gap: 12px; padding: 15px; margin: 15px 0 25px 0; }
                .nav-button { padding: 20px 10px; min-height: 90px; }
                .nav-button i { font-size: 1.6rem; margin-bottom: 8px; }
                .nav-button span { font-size: 0.8rem; }
                body, main { overflow-x: hidden; }
                .card { padding: 20px !important; }
            }
            
            @media (max-width: 480px) {
                .nav-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 10px; }
                .nav-button { padding: 18px 8px; min-height: 85px; }
                .nav-button i { font-size: 1.5rem; }
                .nav-button span { font-size: 0.75rem; }
            }
        </style>
    </head>
    <body class="day-mode homepage theme-blue auth-loading">
        <div id="preloader"><div class="loader"></div></div>

        <!-- Navigation Grid -->
        <nav class="nav-grid">
            <a href="../../../../index.html" class="nav-button color-home">
                <i class="fa-solid fa-house"></i>
                <span>‡¶π‡ßã‡¶Æ</span>
            </a>
            <a href="#dashboard" class="nav-button color-dashboard">
                <i class="fa-solid fa-chart-line"></i>
                <span>‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</span>
            </a>
            <a href="#class-notes" class="nav-button color-notes">
                <i class="fa-solid fa-book-open"></i>
                <span>‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßã‡¶ü</span>
            </a>
            <a href="#pdf-notes" class="nav-button color-pdf">
                <i class="fa-solid fa-file-pdf"></i>
                <span>‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´</span>
            </a>
            <a href="#quiz-sets" class="nav-button color-quiz">
                <i class="fa-solid fa-file-circle-question"></i>
                <span>‡¶ï‡ßÅ‡¶á‡¶ú</span>
            </a>
            <a href="#leaderboard" class="nav-button color-leaderboard">
                <i class="fa-solid fa-trophy"></i>
                <span>‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</span>
            </a>
        </nav>

        <main>
            <script>
                // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤
                let CURRENT_CHAPTER_NAME = "";

                // chapter-info.json ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
                async function loadChapterData() {
                    try {
                        const response = await fetch('data/chapter-info.json');
                        const data = await response.json();
                        
                        // ‡ßß. ‡¶ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                        CURRENT_CHAPTER_NAME = data.chapterID;
                        
                        // ‡ß®. ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
                        document.getElementById('dynamic-title').innerText = data.chapterName + " | Study With Keshab";
                        
                        // ‡ß©. ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ
                        window.__CHAPTER_BANNER__ = `
                            <div class="chapter-banner">
                                <h1>${data.chapterName}</h1>
                                <p>${data.description}</p>
                            </div>
                        `;

                        // ‡ß™. ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ (‡¶Ø‡¶¶‡¶ø ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶® ‡¶π‡¶Ø‡¶º)
                        if (typeof init === 'function') init(); 
                        
                        console.log("Chapter Loaded:", CURRENT_CHAPTER_NAME);
                    } catch (error) {
                        console.error("Error loading chapter info:", error);
                    }
                }

                // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá
                loadChapterData();
            </script>

            <!-- ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
            <section class="card" id="dashboard">
                <h2><i class="fa-solid fa-chart-line icon-title"></i> ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</h2>
                
                <div class="quick-stats-grid">
                    <div class="stat-card"><div class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶ï‡ßÅ‡¶á‡¶ú</div><div class="stat-number" id="total-quizzes">0</div></div>
                    <div class="stat-card"><div class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡ßç‡¶ï‡ßã‡¶∞</div><div class="stat-number" id="total-score">0</div></div>
                    <div class="stat-card"><div class="stat-label">‡¶ó‡ßú ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</div><div class="stat-number" id="average-score">0</div></div>
                </div>

                <div class="streak-container">
                    <div class="streak-icon">üî•</div>
                    <div class="streak-info"><h3 id="streak-days">0 ‡¶¶‡¶ø‡¶®</h3><p>‡¶ß‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶π‡¶ø‡¶ï‡¶§‡¶æ</p></div>
                </div>

                <div class="motivational-quote-box">
                    <p id="daily-quote">"‡¶∏‡¶´‡¶≤‡¶§‡¶æ ‡¶π‡¶≤‡ßã ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶õ‡ßã‡¶ü ‡¶õ‡ßã‡¶ü ‡¶™‡ßç‡¶∞‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ‡¶∞ ‡¶´‡¶≤‡•§"</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-item">
                        <h3>‡¶Ö‡¶ß‡ßç‡¶Ø‡¶æ‡ßü‡ßá‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø</h3>
                        <div class="progress-bar-container"><div class="progress-bar" id="chapter-progress-bar" style="width: 0%"></div></div>
                        <p id="chapter-progress-text">0% ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®</p>
                    </div>
                    <div class="dashboard-item">
                        <h3>‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü</h3>
                        <canvas id="quiz-pie-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßã‡¶ü (JS ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá) -->
            <section class="card" id="class-notes">
                <h2><i class="fa-solid fa-book-open icon-title"></i> ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßã‡¶ü</h2>
                <div class="link-container styled-list" id="class-list-container">
                    <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                </div>
            </section>

            <!-- ‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶®‡ßã‡¶ü -->
            <section class="card" id="pdf-notes">
                <h2><i class="fa-solid fa-file-pdf icon-title"></i> ‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶®‡ßã‡¶ü</h2>
                <div class="pdf-grid" id="pdf-grid-container">
                    <div style="text-align:center; width:100%;">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
                </div>
            </section>

            <!-- ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶∏‡ßá‡¶ü (JS ‡¶¶‡¶ø‡ßü‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá) -->
            <section class="card" id="quiz-sets">
                <h2><i class="fa-solid fa-file-circle-question icon-title"></i> ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶∏‡ßá‡¶ü</h2>
                <div class="link-container styled-list" id="quiz-list-container">
                    <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                </div>
            </section>

            <!-- ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
            <section class="card" id="leaderboard">
                <h2><i class="fa-solid fa-trophy icon-title"></i> ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</h2>
                <div class="leaderboard-container">
                    <table>
                        <thead><tr><th>#</th><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶∏‡ßç‡¶ï‡ßã‡¶∞</th></tr></thead>
                        <tbody id="leaderboard-body"></tbody>
                    </table>
                </div>
            </section>
        </main>

        <!-- PDF Modal & Scripts -->
        <div id="fullScreenPdfModal" class="pdf-modal" style="display: none;">
            <div class="pdf-toolbar">
                <div class="toolbar-section">
                    <button class="control-btn" onclick="closePdf()" title="Close">
                        <i class="fa-solid fa-xmark"></i>
                    </button>
                    <span class="pdf-modal-title" id="pdfModalTitle">PDF Viewer</span>
                </div>
                <div class="toolbar-section">
                    <button class="control-btn" onclick="adjustZoom(-0.1)" title="Zoom Out">
                        <i class="fa-solid fa-minus"></i>
                    </button>
                    <button class="control-btn" onclick="adjustZoom(0.1)" title="Zoom In">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                    <button class="control-btn" onclick="rotatePdf()" title="Rotate">
                        <i class="fa-solid fa-rotate-right"></i>
                    </button>
                </div>
            </div>
            <div class="frame-container">
                <div class="loader-overlay" id="pdfLoader">
                    <div class="spinner"></div>
                    <span>Loading PDF...</span>
                </div>
                <iframe id="pdfViewerFrame" class="pdf-viewer-frame"></iframe>
            </div>
        </div>

        <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
        <script src="../../../js/firebase-config.js"></script>
        
        <script>
            window.__MANUAL_ROOT_PATH__ = '../../../';
            // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞‡¶ü‡¶ø ‡¶è‡¶ñ‡¶® ‡¶â‡¶™‡¶∞‡ßá‡¶∞ loadChapterData() ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶ü ‡¶π‡¶¨‡ßá
        </script>
        
        <script src="../../../js/navigation.js"></script>
        <script src="../../../auth.js"></script>
        <script src="js/main-renderer.js"></script>
        <script src="js/pdf-viewer.js"></script>
        
        <script>
            // Fallback: 5 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶≤‡ßã‡¶° ‡¶®‡¶æ ‡¶π‡¶≤‡ßá ‡¶ú‡ßã‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
            setTimeout(() => {
                document.body.classList.remove("auth-loading");
            }, 5000);
        </script> 
    </body>
</html>